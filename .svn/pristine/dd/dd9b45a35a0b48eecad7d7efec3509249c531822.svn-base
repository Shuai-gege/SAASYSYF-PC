{"remainingRequest":"D:\\ysyf\\vue-link-admin-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ysyf\\vue-link-admin-master\\src\\views\\component\\excel\\merge-header.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ysyf\\vue-link-admin-master\\src\\views\\component\\excel\\merge-header.vue","mtime":1578643849000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { formatDateTime } from '@/utils'\nexport default {\n  name: 'MergeHeader',\n  data() {\n    return {\n      list: [\n        {\n          id: 1,\n          title: '111111111111',\n          author: '哈哈',\n          pageviews: 200,\n          timestamp: 1574473177122\n        },\n        {\n          id: 2,\n          title: '222222222222',\n          author: '嘿嘿',\n          pageviews: 566,\n          timestamp: 1574473177122\n        },\n        {\n          id: 3,\n          title: '333333333333333',\n          author: '嗯嗯',\n          pageviews: 5956,\n          timestamp: 1574473177122\n        }\n      ],\n      downloadLoading: false\n    }\n  },\n  created() {\n  },\n  methods: {\n    handleDownload() {\n      this.downloadLoading = true\n        import('@/vendor/Export2Excel').then(excel => {\n          const multiHeader = [['Id', 'Main Information', '', '', 'Date']]\n          const header = ['', 'Title', 'Author', 'Readings', '']\n          const filterVal = ['id', 'title', 'author', 'pageviews', 'display_time']\n          const list = this.list\n          const data = this.formatJson(filterVal, list)\n          const merges = ['A1:A2', 'B1:D1', 'E1:E2']\n          excel.export_json_to_excel({\n            multiHeader,\n            header,\n            merges,\n            data\n          })\n          this.downloadLoading = false\n        })\n    },\n    formatJson(filterVal, jsonData) {\n      return jsonData.map(v => filterVal.map(j => {\n        if (j === 'timestamp') {\n          return formatDateTime(v[j])\n        } else {\n          return v[j]\n        }\n      }))\n    }\n  }\n}\n",null]}
{"remainingRequest":"D:\\ysyf\\vue-link-admin-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ysyf\\vue-link-admin-master\\src\\views\\profile\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ysyf\\vue-link-admin-master\\src\\views\\profile\\index.vue","mtime":1582007741797},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ysyf\\vue-link-admin-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport store from '@/store'\nimport { MessageBox, Message } from 'element-ui'\nimport { mapGetters } from \"vuex\";\nimport { modifyPwd } from \"@/api/permission/user\";\nimport PanThumb from \"@/components/PanThumb\";\nimport Activity from \"./components/Activity\"\n\nexport default {\n  name: \"Profile\",\n  components: { PanThumb , Activity},\n  data() {\n    const validatePassord = (rule, value, callback) => {\n      if (value.length < 6) {\n        callback(new Error(\"密码长度不能小于6\"));\n      } else {\n        callback();\n      }\n    };\n    return {\n      activeTab: \"修改密码\",\n      passwordForm: {\n        oldPassword: \"\",\n        newPassword: \"\",\n        confirmNewPassword: \"\"\n      },\n      passwordRules: {\n        oldPassword: [\n          { required: true, trigger: \"blur\", validator: validatePassord }\n        ],\n        newPassword: [\n          { required: true, trigger: \"blur\", validator: validatePassord }\n        ],\n        confirmNewPassword: [\n          { required: true, trigger: \"blur\", validator: validatePassord }\n        ]\n      }\n    };\n  },\n  computed: {\n    ...mapGetters([\"userinfo\", \"roles\"])\n  },\n  created() {},\n  methods: {\n    submitPassword() {\n      this.$refs.passwordForm.validate(valid => {\n\n        if (valid) {\n          this.loading = true;\n          modifyPwd(this.passwordForm).then(response => {\n            this.loading = false;\n            MessageBox.confirm(\n              \"密码修改成功, 为确保安全,请重新登录\",\n              \"提示\",\n              {\n                confirmButtonText: \"重新登录\",\n                cancelButtonText: \"取消\",\n                type: \"warning\"\n              }\n            ).then(() => {\n              store.dispatch(\"user/resetToken\").then(() => {\n                location.reload();\n              });\n            });\n          });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    }\n  }\n};\n",null]}
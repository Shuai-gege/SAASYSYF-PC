{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4fcfd37c\"],{\"34bd\":function(e,t,r){\"use strict\";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",{staticClass:\"app-container\"},[r(\"div\",{staticStyle:{\"margin-top\":\"20px\",\"max-width\":\"600px\",\"margin-left\":\"80px\"}},[r(\"el-row\",{attrs:{gutter:30}},[r(\"el-col\",{attrs:{span:10}},[r(\"el-input\",{attrs:{placeholder:\"输入关键字进行过滤\",clearable:\"\"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:\"filterText\"}})],1),e._v(\" \"),r(\"el-col\",{attrs:{span:30}},[r(\"el-button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"/rest/department/companyAdd\"],expression:\"['/rest/department/companyAdd']\"}],staticClass:\"filter-item\",attrs:{type:\"primary\"},on:{click:function(t){return e.handleCreate()}}},[r(\"i\",{staticClass:\"el-icon-plus\"}),e._v(\" 添加企业/部门\\n          \")])],1)],1),e._v(\" \"),r(\"el-row\",{staticStyle:{\"padding-top\":\"20px\"}},[r(\"el-col\",[r(\"el-tree\",{ref:\"tree\",staticClass:\"permission-tree\",attrs:{data:e.departments,props:e.defaultProps,\"node-key\":\"id\",\"default-expand-all\":\"\",\"expand-on-click-node\":!1,\"filter-node-method\":e.filterNode},scopedSlots:e._u([{key:\"default\",fn:function(t){var n=t.node,a=t.data;return r(\"span\",{staticClass:\"custom-tree-node\"},[r(\"span\",[e._v(e._s(n.label))]),e._v(\" \"),r(\"span\",[r(\"el-button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"/rest/department/add\"],expression:\"['/rest/department/add']\"}],attrs:{type:\"text\",size:\"mini\"},on:{click:function(){return e.handleCreate(a)}}},[e._v(\"添加子项\")]),e._v(\" \"),r(\"el-button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"/rest/department/update\"],expression:\"['/rest/department/update']\"}],attrs:{type:\"text\",size:\"mini\"},on:{click:function(){return e.handleEdit(n,a)}}},[e._v(\"编辑\")]),e._v(\" \"),r(\"el-button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"/rest/department/delete\"],expression:\"['/rest/department/delete']\"}],attrs:{type:\"text\",size:\"mini\"},on:{click:function(){return e.handleDelete(a)}}},[e._v(\"删除\")])],1)])}}])})],1)],1)],1),e._v(\" \"),r(\"el-dialog\",{attrs:{visible:e.dialogVisible,title:\"edit\"===e.dialogType?\"编辑\":\"新增\"},on:{\"update:visible\":function(t){e.dialogVisible=t}}},[r(\"el-form\",{ref:\"form\",attrs:{model:e.company,rules:e.rules,\"label-width\":\"80px\",\"label-position\":\"right\"}},[r(\"el-form-item\",{staticStyle:{width:\"100%\"},attrs:{label:\"类型\",prop:\"department.deptCompany\"}},[r(\"el-select\",{attrs:{placeholder:\"请选择\"},on:{change:e.getDeptCompany},model:{value:e.company.department.deptCompany,callback:function(t){e.$set(e.company.department,\"deptCompany\",t)},expression:\"company.department.deptCompany\"}},[r(\"el-option\",{attrs:{label:\"部门\",value:1}}),e._v(\" \"),r(\"el-option\",{attrs:{label:\"企业\",value:2}})],1)],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:e.isCompany?\"企业名称\":\"部门名称\",prop:\"department.name\"}},[r(\"el-input\",{attrs:{placeholder:e.isCompany?\"企业名称\":\"部门名称\"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,\"name\",t)},expression:\"company.department.name\"}})],1),e._v(\" \"),e.isDepartment?r(\"el-form-item\",{attrs:{label:\"上级部门\",prop:\"department.parentId\"}},[r(\"treeselect\",{attrs:{options:e.companySubDepartments,normalizer:e.normalizer,placeholder:\"选择上级部门\"},model:{value:e.company.department.parentId,callback:function(t){e.$set(e.company.department,\"parentId\",t)},expression:\"company.department.parentId\"}})],1):e._e(),e._v(\" \"),e.isCompany?r(\"el-form-item\",{attrs:{label:\"管理账号\",prop:\"user.name\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入手机号\"},model:{value:e.company.user.name,callback:function(t){e.$set(e.company.user,\"name\",t)},expression:\"company.user.name\"}})],1):e._e(),e._v(\" \"),e.isCompany?r(\"el-form-item\",{attrs:{label:\"密码\",prop:\"user.password\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入密码\",\"show-password\":\"\"},model:{value:e.company.user.password,callback:function(t){e.$set(e.company.user,\"password\",t)},expression:\"company.user.password\"}})],1):e._e(),e._v(\" \"),e.isCompany?r(\"el-form-item\",{attrs:{label:\"真实姓名\",prop:\"user.vserName\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入姓名\"},model:{value:e.company.user.vserName,callback:function(t){e.$set(e.company.user,\"vserName\",t)},expression:\"company.user.vserName\"}})],1):e._e(),e._v(\" \"),e.isCompany?r(\"el-form-item\",{attrs:{label:\"角色\",prop:\"user.roleIds\"}},[r(\"el-select\",{staticStyle:{width:\"100%\"},attrs:{multiple:\"\",placeholder:\"请选择\"},model:{value:e.company.user.roleIds,callback:function(t){e.$set(e.company.user,\"roleIds\",t)},expression:\"company.user.roleIds\"}},e._l(e.roles,(function(e){return r(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"排序\"}},[r(\"el-input\",{attrs:{placeholder:\"排序\"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,\"sorts\",t)},expression:\"company.department.sorts\"}})],1)],1),e._v(\" \"),r(\"div\",{staticStyle:{\"text-align\":\"right\"}},[r(\"el-button\",{attrs:{type:\"danger\"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(\"取消\")]),e._v(\" \"),r(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.confirmDepartment}},[e._v(\"确定\")])],1)],1),e._v(\" \"),r(\"el-dialog\",{attrs:{visible:e.dialogVisibleEdit,title:\"编辑\"},on:{\"update:visible\":function(t){e.dialogVisibleEdit=t}}},[r(\"el-form\",{ref:\"form\",attrs:{model:e.company,rules:e.rules,\"label-width\":\"80px\",\"label-position\":\"right\"}},[r(\"el-form-item\",{staticStyle:{width:\"100%\"},attrs:{label:\"类型\",prop:\"department.deptCompany\"}},[r(\"el-select\",{attrs:{placeholder:\"请选择\"},on:{change:e.getDeptCompany},model:{value:e.company.department.deptCompany,callback:function(t){e.$set(e.company.department,\"deptCompany\",t)},expression:\"company.department.deptCompany\"}},[r(\"el-option\",{attrs:{label:\"部门\",value:1}}),e._v(\" \"),r(\"el-option\",{attrs:{label:\"企业\",value:2}})],1)],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:e.isCompany?\"企业名称\":\"部门名称\",prop:\"department.name\"}},[r(\"el-input\",{attrs:{placeholder:e.isCompany?\"企业名称\":\"部门名称\"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,\"name\",t)},expression:\"company.department.name\"}})],1),e._v(\" \"),e.isDepartment?r(\"el-form-item\",{attrs:{label:\"上级部门\",prop:\"department.parentId\"}},[r(\"treeselect\",{attrs:{options:e.companySubDepartments,normalizer:e.normalizer,placeholder:\"选择上级部门\"},model:{value:e.company.department.parentId,callback:function(t){e.$set(e.company.department,\"parentId\",t)},expression:\"company.department.parentId\"}})],1):e._e(),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"排序\"}},[r(\"el-input\",{attrs:{placeholder:\"排序\"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,\"sorts\",t)},expression:\"company.department.sorts\"}})],1)],1),e._v(\" \"),r(\"div\",{staticStyle:{\"text-align\":\"right\"}},[r(\"el-button\",{attrs:{type:\"danger\"},on:{click:function(t){e.dialogVisibleEdit=!1}}},[e._v(\"取消\")]),e._v(\" \"),r(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.confirmDepartment}},[e._v(\"确定\")])],1)],1),e._v(\" \"),r(\"el-dialog\",{attrs:{visible:e.dialogTopCompanyAdd,title:\"新增\"},on:{\"update:visible\":function(t){e.dialogTopCompanyAdd=t}}},[r(\"el-form\",{ref:\"form\",attrs:{model:e.company,rules:e.rules,\"label-width\":\"80px\",\"label-position\":\"right\"}},[r(\"el-form-item\",{attrs:{label:\"企业名称\",prop:\"department.name\"}},[r(\"el-input\",{attrs:{placeholder:\"企业名称\"},model:{value:e.company.department.name,callback:function(t){e.$set(e.company.department,\"name\",t)},expression:\"company.department.name\"}})],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"管理账号\",prop:\"user.name\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入手机号\"},model:{value:e.company.user.name,callback:function(t){e.$set(e.company.user,\"name\",t)},expression:\"company.user.name\"}})],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"密码\",prop:\"user.password\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入密码\",\"show-password\":\"\"},model:{value:e.company.user.password,callback:function(t){e.$set(e.company.user,\"password\",t)},expression:\"company.user.password\"}})],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"真实姓名\",prop:\"user.vserName\"}},[r(\"el-input\",{attrs:{placeholder:\"请输入姓名\"},model:{value:e.company.user.vserName,callback:function(t){e.$set(e.company.user,\"vserName\",t)},expression:\"company.user.vserName\"}})],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"角色\",prop:\"user.roleIds\"}},[r(\"el-select\",{staticStyle:{width:\"100%\"},attrs:{multiple:\"\",placeholder:\"请选择\"},model:{value:e.company.user.roleIds,callback:function(t){e.$set(e.company.user,\"roleIds\",t)},expression:\"company.user.roleIds\"}},e._l(e.roles,(function(e){return r(\"el-option\",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(\" \"),r(\"el-form-item\",{attrs:{label:\"排序\"}},[r(\"el-input\",{attrs:{placeholder:\"排序\"},model:{value:e.company.department.sorts,callback:function(t){e.$set(e.company.department,\"sorts\",t)},expression:\"company.department.sorts\"}})],1)],1),e._v(\" \"),r(\"div\",{staticStyle:{\"text-align\":\"right\"}},[r(\"el-button\",{attrs:{type:\"danger\"},on:{click:function(t){e.dialogTopCompanyAdd=!1}}},[e._v(\"取消\")]),e._v(\" \"),r(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.confirmDepartment}},[e._v(\"确定\")])],1)],1)],1)},a=[],s=(r(\"ac6a\"),r(\"7f7f\"),r(\"96cf\"),r(\"3b8d\")),o=r(\"bd86\"),i=r(\"ca17\"),l=r.n(i),p=(r(\"542c\"),r(\"4381\")),c=r(\"653d\"),m=r(\"db93\"),d=r(\"ed08\"),u={id:void 0,name:\"\",parentId:void 0,parentName:\"\",levels:void 0,deleted:0,deptCompany:1},f={name:\"\",password:\"\",vserName:\"\",roleIds:[]},y={department:{id:void 0,name:\"\",parentId:void 0,parentName:\"\",levels:void 0,deleted:0,deptCompany:1},user:{name:\"\",password:\"\",vserName:\"\",roleIds:[]}},b={name:\"Department\",components:{Treeselect:l.a},directives:{permission:p[\"a\"]},data:function(){var e,t=function(e,t,r){return t&&/^1(3|4|5|6|7|8|9)\\d{9}$/.test(t)?void 0:r(new Error(\"请输入正确的账号\"))};return{defaultProps:{children:\"childrens\",label:\"name\"},department:Object.assign({},u),user:Object.assign({},f),departments:[],companySubDepartments:[],roles:[],dialogVisible:!1,dialogType:\"new\",dialogTopCompanyAdd:!1,dialogVisibleEdit:!1,isCompany:!1,isDepartment:!0,company:Object.assign({},y),levelsOptions:[{label:\"集团\",key:0},{label:\"分公司\",key:1},{label:\"部门\",key:2}],filterText:\"\",rules:(e={},Object(o[\"a\"])(e,\"department.deptCompany\",[{required:!0,message:\"请选择部门类型\",trigger:\"change\"}]),Object(o[\"a\"])(e,\"department.name\",[{required:!0,message:\"请输入部门名\",trigger:\"blur\"},{min:2,max:15,message:\"长度在 2 到 15 个字符\",trigger:\"blur\"}]),Object(o[\"a\"])(e,\"department.parentId\",[{required:!0,message:\"请选择上级部门\",trigger:\"change\"}]),Object(o[\"a\"])(e,\"user.name\",[{required:!0,message:\"请输入正确的账号\",trigger:\"blur\"},{validator:t,trigger:\"blur\"}]),Object(o[\"a\"])(e,\"user.vserName\",[{required:!0,message:\"请输入姓名\",trigger:\"blur\"}]),Object(o[\"a\"])(e,\"user.roleIds\",[{required:!0,message:\"请选择角色\",trigger:\"change\"}]),e)}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},created:function(){this.getRoles(),this.getSubDepartments(),this.getCompanySubDepartments()},methods:{getSubDepartments:function(){var e=Object(s[\"a\"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c[\"g\"])();case 2:t=e.sent,r=t.result,this.diGuiTree(r),this.departments=r;case 6:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getCompanySubDepartments:function(){var e=Object(s[\"a\"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c[\"c\"])();case 2:t=e.sent,r=t.result,this.diGuiTree(r),this.companySubDepartments=r;case 6:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getRoles:function(){var e=Object(s[\"a\"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m[\"e\"])();case 2:t=e.sent,this.roles=t.result;case 4:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getDeptCompany:function(){2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0)},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},diGuiTree:function(e){var t=this;e.forEach((function(e){\"\"===e.childrens||void 0===e.childrens||null===e.childrens?delete e.childrens:t.diGuiTree(e.childrens)}))},normalizer:function(e){return{id:e.id,label:e.name,children:e.childrens}},topCompanyCreate:function(e){this.dialogTopCompanyAdd=!0,this.dialogType=\"topCompanyAdd\",this.company=Object.assign({},y),this.user=Object.assign({},f)},handleCreate:function(e){this.dialogType=\"new\",this.dialogVisible=!0,this.company.department=Object.assign({},y.department),this.company.user=Object.assign({},y.user),2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0)},handleEdit:function(){var e=Object(s[\"a\"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.dialogType=\"edit\",this.dialogVisibleEdit=!0,this.company.department=Object(d[\"c\"])(r),2===this.company.department.deptCompany?(this.isCompany=!0,this.isDepartment=!1):(this.isCompany=!1,this.isDepartment=!0);case 4:case\"end\":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),confirmDepartment:function(){var e=Object(s[\"a\"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(\"edit\"!==this.dialogType){e.next=5;break}return e.next=3,Object(c[\"i\"])(this.company.department);case 3:e.next=14;break;case 5:if(\"new\"!==this.dialogType){e.next=11;break}return this.company.user.password.length<1&&(this.company.user.password=this.company.user.name),e.next=9,Object(c[\"a\"])(this.company);case 9:e.next=14;break;case 11:if(\"topCompanyAdd\"!==this.dialogType){e.next=14;break}return e.next=14,Object(c[\"b\"])(this.company);case 14:this.dialogVisible=!1,this.dialogTopCompanyAdd=!1,this.dialogVisibleEdit=!1,this.$message({showClose:!0,message:\"保存成功\",type:\"success\"}),this.getSubDepartments();case 19:case\"end\":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(e){var t=this;this.$confirm(\"确认删除?\",\"警告\",{confirmButtonText:\"确定\",cancelButtonText:\"取消\",type:\"warning\"}).then(Object(s[\"a\"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(c[\"d\"])(e.id);case 2:t.$message({showClose:!0,message:\"删除成功\",type:\"success\"}),t.getSubDepartments();case 4:case\"end\":return r.stop()}}),r)})))).catch((function(e){console.error(e)}))}}},h=b,v=(r(\"5771\"),r(\"2877\")),g=Object(v[\"a\"])(h,n,a,!1,null,null,null);t[\"default\"]=g.exports},\"393b\":function(e,t,r){},4381:function(e,t,r){\"use strict\";r(\"ac4d\"),r(\"8a81\"),r(\"ac6a\");var n=r(\"4360\"),a={inserted:function(e,t,r){var a=t.value,s=n[\"a\"].getters&&n[\"a\"].getters.permissions;if(!(a&&a instanceof Array&&a.length>0&&s))throw new Error(\"need permissions! Like v-permission=\\\"['/rest/user/list']\\\"\");var o=!1,i=!0,l=!1,p=void 0;try{for(var c,m=s[Symbol.iterator]();!(i=(c=m.next()).done);i=!0){var d=c.value;if(d.url===a[0]){o=!0;break}}}catch(u){l=!0,p=u}finally{try{i||null==m.return||m.return()}finally{if(l)throw p}}o||e.remove()}},s=function(e){e.directive(\"permission\",a)};window.Vue&&(window[\"permission\"]=a,Vue.use(s)),a.install=s;t[\"a\"]=a},5771:function(e,t,r){\"use strict\";var n=r(\"393b\"),a=r.n(n);a.a},\"653d\":function(e,t,r){\"use strict\";r.d(t,\"e\",(function(){return a})),r.d(t,\"g\",(function(){return s})),r.d(t,\"h\",(function(){return o})),r.d(t,\"c\",(function(){return i})),r.d(t,\"f\",(function(){return l})),r.d(t,\"a\",(function(){return p})),r.d(t,\"b\",(function(){return c})),r.d(t,\"i\",(function(){return m})),r.d(t,\"d\",(function(){return d}));var n=r(\"b775\");function a(){return Object(n[\"a\"])({url:\"/rest/department/all\",method:\"get\"})}function s(){return Object(n[\"a\"])({url:\"/rest/department/subDept\",method:\"get\"})}function o(e){return Object(n[\"a\"])({url:\"/rest/department/subDeptByDeptId\",method:\"get\",params:{deptId:e}})}function i(){return Object(n[\"a\"])({url:\"/rest/department/companySubDeptList\",method:\"get\"})}function l(){return Object(n[\"a\"])({url:\"/rest/department/subCompanyList\",method:\"get\"})}function p(e){return Object(n[\"a\"])({url:\"/rest/department/companyAdd\",method:\"post\",data:e})}function c(e){return Object(n[\"a\"])({url:\"/rest/department/topCompanyAdd\",method:\"post\",data:e})}function m(e){return Object(n[\"a\"])({url:\"/rest/department/update\",method:\"post\",data:e})}function d(e){return Object(n[\"a\"])({url:\"/rest/department/delete\",method:\"get\",params:{id:e}})}},db93:function(e,t,r){\"use strict\";r.d(t,\"d\",(function(){return a})),r.d(t,\"e\",(function(){return s})),r.d(t,\"a\",(function(){return o})),r.d(t,\"g\",(function(){return i})),r.d(t,\"b\",(function(){return l})),r.d(t,\"f\",(function(){return p})),r.d(t,\"c\",(function(){return c}));var n=r(\"b775\");function a(e){return Object(n[\"a\"])({url:\"/rest/role/list\",method:\"post\",data:e})}function s(){return Object(n[\"a\"])({url:\"/rest/role/all\",method:\"get\"})}function o(e){return Object(n[\"a\"])({url:\"/rest/role/add\",method:\"post\",data:e})}function i(e){return Object(n[\"a\"])({url:\"/rest/role/update\",method:\"post\",data:e})}function l(e){return Object(n[\"a\"])({url:\"/rest/role/delete\",method:\"get\",params:{id:e}})}function p(e){return Object(n[\"a\"])({url:\"/rest/role/saveDataScope\",method:\"post\",data:e})}function c(e){return Object(n[\"a\"])({url:\"/rest/role/queryDataScope\",method:\"get\",params:{id:e}})}}}]);","extractedComments":[]}
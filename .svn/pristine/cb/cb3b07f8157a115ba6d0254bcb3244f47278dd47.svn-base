{"remainingRequest":"D:\\ysyf\\iguard-vue01\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ysyf\\iguard-vue01\\src\\views\\component\\excel\\select-excel.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ysyf\\iguard-vue01\\src\\views\\component\\excel\\select-excel.vue","mtime":1586084705000},{"path":"D:\\ysyf\\iguard-vue01\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1586085021683},{"path":"D:\\ysyf\\iguard-vue01\\node_modules\\babel-loader\\lib\\index.js","mtime":1586085013966},{"path":"D:\\ysyf\\iguard-vue01\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1586085021683},{"path":"D:\\ysyf\\iguard-vue01\\node_modules\\vue-loader\\lib\\index.js","mtime":1586085255129}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nexport default {\n  name: 'SelectExcel',\n  data() {\n    return {\n      list: [\n        {\n          id: 1,\n          title: '111111111111',\n          author: '哈哈',\n          pageviews: 200,\n          timestamp: 1574473177122\n        },\n        {\n          id: 2,\n          title: '222222222222',\n          author: '嘿嘿',\n          pageviews: 566,\n          timestamp: 1574473177122\n        },\n        {\n          id: 3,\n          title: '333333333333333',\n          author: '嗯嗯',\n          pageviews: 5956,\n          timestamp: 1574473177122\n        }\n      ],\n      multipleSelection: [],\n      downloadLoading: false,\n      filename: ''\n    }\n  },\n  created() {},\n  methods: {\n    handleSelectionChange(val) {\n      this.multipleSelection = val\n    },\n    handleDownload() {\n      if (this.multipleSelection.length) {\n        this.downloadLoading = true\n        import('@/vendor/Export2Excel').then(excel => {\n          const tHeader = ['Id', 'Title', 'Author', 'Readings', 'Date']\n          const filterVal = [\n            'id',\n            'title',\n            'author',\n            'pageviews',\n            'timestamp'\n          ]\n          const list = this.multipleSelection\n          const data = this.formatJson(filterVal, list)\n          excel.export_json_to_excel({\n            header: tHeader,\n            data,\n            filename: this.filename\n          })\n          this.$refs.multipleTable.clearSelection()\n          this.downloadLoading = false\n        })\n      } else {\n        this.$message({\n          message: 'Please select at least one item',\n          type: 'warning'\n        })\n      }\n    },\n    formatJson(filterVal, jsonData) {\n      return jsonData.map(v => filterVal.map(j => v[j]))\n    }\n  }\n}\n",null]}
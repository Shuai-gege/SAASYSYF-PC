{"remainingRequest":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\src\\views\\permission\\kejenkj\\upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\src\\views\\permission\\kejenkj\\upload.vue","mtime":1578814377703},{"path":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workspace\\selfcompanyworkspace\\vue-link-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getToken } from '@/utils/auth'\nimport Treeselect from '@riophae/vue-treeselect';\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css';\nimport permission from '@/directive/permission/index.js'; // 权限判断指令\nimport {\n  uploadList\n} from '@/api/permission/kejenkj/upload'\nimport { departments } from '@/api/permission/department'\nimport { jobs } from '@/api/permission/job'\nimport { roles } from '@/api/permission/role'\nimport { deepClone } from '@/utils'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nconst token = getToken()\nconst defaultUpload = {\n  uid: '',\n  name: '',\n  password: 123456,\n  vserName: '',\n  mobile: '',\n  state: 1,\n  email: '',\n  deptid: undefined,\n  jobid: undefined,\n  jobName: '',\n  deptName: '',\n  roleIds: []\n}\nexport default {\n  name: `Upload`,\n  components: { Pagination, Treeselect },\n  directives: { permission },\n  data(){\n    return{\n      list: null,\n      total: 0,\n      tableKey: 0,\n      listLoading: false,\n      listQuery: {\n        page: 1,\n        limit: 10,\n        title: '', // 资料名称\n        description: '', // 资料描述\n        createtime: '', //\n      },\n      headersObj: { 'LinkAdmin-Token': token },\n      roles: [],\n      activeName: 'first',\n      dialogVisible: false,\n      dialogType: 'new',\n      user: Object.assign({}, defaultUpload),\n    }\n  },\n  watch: {\n    searchDeptName(val) {\n      this.$refs.serchDeptTree.filter(val)\n    }\n  },\n  created() {},\n  mounted() {\n    this.getList()\n    this.getJobs()\n    this.getRoles()\n  },\n  methods:{\n    async getList() {\n      this.listLoading = true\n      try {\n        const res = await uploadList(this.listQuery)\n        this.listLoading = false\n        this.list = res.result.rows\n        this.total = res.result.records\n      } catch (e) {\n        this.listLoading = false\n      }\n    },\n    async getRoles() {\n      const res = await roles()\n      this.roles = res.result\n    },\n    async getJobs() {\n      const res = await jobs()\n      this.jobs = res.result\n    },\n    // 查询\n    handleSearch() {\n      this.getList()\n    },\n\n    // 修改\n    handleEdit(scope) {\n      this.dialogType = 'edit'\n      this.activeName = 'first'\n      this.dialogVisible = true\n      scope.row.roleIds = []\n      this.user = deepClone(scope.row)\n      if (this.user.roles) {\n        const roleIds = this.user.roleIds\n        this.user.roles.forEach(role => {\n          roleIds.push(role.id)\n        })\n      }\n    },\n  }\n}\n",null]}